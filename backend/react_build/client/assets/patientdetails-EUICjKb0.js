import{z as E,R as s,p as e,w as W,y as z}from"./chunk-4WY6JWTD-DFeZLFN5.js";/* empty css                 *//* empty css            */import{C as R}from"./cancelsavebtn-CxQDzKWk.js";/* empty css                        */function B(u){const{id:o}=E(),_=new Date,[l,r]=s.useState(),[c,N]=s.useState(),[p,j]=s.useState({patient_id:o,appointment_id:null,weight:"",temperature:"",visit_datetime:_.toISOString().replace("T"," ").slice(0,19),service_id:1,staff_id:c?[0].staff_id:0,notes:""}),[g,S]=s.useState(),[a,v]=s.useState([]);s.useEffect(()=>{fetch("http://localhost:5000/getall?table=services").then(i=>i.json()).then(i=>r(i)),fetch("http://localhost:5000/getall?table=staff").then(i=>i.json()).then(i=>N(i)),fetch("http://localhost:5000/getallmedicine").then(i=>i.json()).then(i=>S(i))},[]),s.useEffect(()=>{c&&c.length>0&&j({...p,staff_id:c[0].staff_id})},[c]);async function C(){const i=await fetch("http://localhost:5000/addvisitlog",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});await fetch("http://localhost:5000/addmedicationdetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),console.log(await i.json()),console.log(a)}console.log(l),console.log(a),console.log(g),console.log(c);function w(){v([...a,{supply_id:g[0].supply_id,auto_deduct:g[0].auto_deduct,quantity:1}])}function b(i,x,h){const n=[...a];n[i][x]=h,console.log(h),x==="supply_id"&&((g?.find(D=>D.supply_id===parseInt(h))).auto_deduct===0?(n[i].auto_deduct=!1,n[i].quantity=0):n[i].auto_deduct=!0),v(n)}function F(i){v(a.filter((x,h)=>h!==i))}return e.jsxs("div",{id:"add-record-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{id:"add-record-form",className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Visit Log"})}),e.jsxs("div",{className:"main-form-content",children:[e.jsxs("label",{htmlFor:"",children:["Date",e.jsx("input",{type:"date",value:new Date().toISOString().split("T")[0],style:{width:"70%"}})]}),e.jsxs("label",{htmlFor:"",children:["Reason",e.jsx("select",{name:"",id:"",style:{display:"block",width:"70%",marginTop:"0.3rem"},value:p?.service_id,onChange:i=>j({...p,service_id:parseInt(i.target.value)}),children:l?.map(i=>e.jsx("option",{value:i.service_id,children:i.service_name}))})]}),e.jsxs("div",{style:{display:"flex",width:"100%",gap:"1rem"},children:[e.jsxs("label",{htmlFor:"weight",children:["Weight",e.jsx("input",{type:"text",id:"weight",value:p?.weight,onChange:i=>j({...p,weight:i.target.value})})]}),e.jsxs("label",{htmlFor:"temp",children:["Temperature",e.jsx("input",{type:"text",id:"temp",value:p?.temperature,onChange:i=>j({...p,temperature:i.target.value})})]})]}),e.jsxs("div",{style:{width:"100%"},children:[e.jsx("label",{children:"Medications"}),a.map((i,x)=>e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.5rem"},children:[e.jsx("select",{value:i.supply_id??"",onChange:h=>b(x,"supply_id",h.target.value),style:{display:"block"},children:g?.map(h=>e.jsx("option",{value:h.supply_id,children:h.supply_name}))}),i.auto_deduct&&e.jsxs("label",{htmlFor:"",style:{width:"150px"},children:["Quantity",e.jsx("input",{type:"number",min:"1",style:{width:"100%"},value:i.quantity,onChange:h=>b(x,"quantity",parseInt(h.target.value))})]}),e.jsx("button",{type:"button",onClick:()=>F(x),style:{border:"none"},children:"X"})]},x)),e.jsx("button",{type:"button",style:{marginTop:"0.5rem",display:"block"},onClick:w,children:"+ Add medication"})]}),e.jsxs("label",{htmlFor:"",children:["Staff",e.jsx("select",{name:"",id:"",style:{display:"block",width:"70%",marginTop:"0.3rem"},value:p?.staff_id,onChange:i=>j({...p,staff_id:parseInt(i.target.value)}),children:c?.map(i=>e.jsxs("option",{value:i.staff_id,children:[i.first_name," ",i.last_name]}))})]}),e.jsxs("label",{htmlFor:"reason",children:["Notes",e.jsx("textarea",{name:"notes",id:"notes",rows:"5",cols:"50",value:p?.notes,onChange:i=>j({...p,notes:i.target.value})})]})]}),e.jsx(R,{hideForm:u.hideForm,submit:C})]})]})}function Q(u){const[o,_]=s.useState(""),[l,r]=s.useState(),[c,N]=s.useState([]),[p,j]=s.useState([]),[g,S]=s.useState([]),[a,v]=s.useState([]),[C,w]=s.useState([]),[b,F]=s.useState([]),[i,x]=s.useState([]),[h,n]=s.useState([]),[k,D]=s.useState(!1),[P,I]=s.useState(!1),[X,G]=s.useState([]),[H,K]=s.useState([]);s.useEffect(()=>{fetch("http://localhost:5000/getallergies").then(t=>t.json()).then(t=>N(t.sort((y,m)=>y.allergy_name.localeCompare(m.allergy_name))))},[]),s.useEffect(()=>{fetch("http://localhost:5000/getconditions").then(t=>t.json()).then(t=>j(t.sort((y,m)=>y.condition_name.localeCompare(m.condition_name))))},[]),s.useEffect(()=>{r(u.studentData),S(u.allergies?.map(t=>t.allergy_id)||[]),v(u.conditions?.map(t=>t.condition_id)||[])},[u.studentData]);function A(t,y){const m=y==="allergy"?t.allergy_id:t.condition_id;y==="allergy"?(w(d=>[...new Set([...d,m])]),S(d=>[...new Set([...d,m])]),F(d=>d.filter(f=>f!==m))):(x(d=>[...new Set([...d,m])]),v(d=>[...new Set([...d,m])]),n(d=>d.filter(f=>f!==m)))}function T(t,y){const m=y==="allergy"?t.allergy_id:t.condition_id;y==="allergy"?(F(d=>[...new Set([...d,m])]),w(d=>d.filter(f=>f!==m)),S(d=>d.filter(f=>f!==m))):(n(d=>[...new Set([...d,m])]),x(d=>d.filter(f=>f!==m)),v(d=>d.filter(f=>f!==m)))}async function O(){C.length!==0&&await fetch("http://localhost:5000/addallergies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l.patient_id,allergies:C})})}async function M(){b.length!==0&&await fetch("http://localhost:5000/deletepatientallergies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l.patient_id,allergies:b})})}async function V(){i.length!==0&&await fetch("http://localhost:5000/addconditions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l.patient_id,conditions:i})})}async function L(){h.length!==0&&await fetch("http://localhost:5000/deletepatientconditions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l.patient_id,conditions:h})})}async function q(){(await(await fetch("http://localhost:5000/updatepatient",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json()).success&&(await O(),await M(),await V(),await L(),alert("Patient Updated Successfully!"),u.hideForm(),u.refetch())}const J=c.map(t=>e.jsxs("li",{children:[e.jsx("input",{type:"checkbox",checked:g.includes(t.allergy_id),onChange:()=>g.includes(t.allergy_id)?T(t,"allergy"):A(t,"allergy")}),e.jsx("label",{children:t.allergy_name})]},t.allergy_id)),$=p.map(t=>e.jsxs("li",{children:[e.jsx("input",{type:"checkbox",checked:a.includes(t.condition_id),onChange:()=>a.includes(t.condition_id)?T(t,"condition"):A(t,"condition")}),e.jsx("label",{children:t.condition_name})]},t.condition_id));return e.jsxs("div",{id:"add-new-patient-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{id:"add-patient-form",className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Add Patient"})}),e.jsxs("div",{id:"main-add-patient-form",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search-by-id",style:{display:"inline-block",marginRight:"1rem"},children:e.jsx("input",{type:"text",id:"search-by-id",placeholder:"Search by ID Number",style:{width:"250px"},value:o,onChange:t=>_(t.target.value)})}),e.jsx("button",{style:{height:"40px",width:"80px",borderRadius:"10px",border:"none"},children:"Search"})]}),e.jsxs("div",{id:"student-information",className:"form-div",children:[e.jsx("p",{className:"form-header",children:"Student Information"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"firstname",children:["First Name",e.jsx("input",{type:"text",id:"firstname",value:l?.first_name||"",onChange:t=>r({...l,first_name:t.target.value})})]}),e.jsxs("label",{htmlFor:"middlename",children:["Middle Name",e.jsx("input",{type:"text",id:"middlename",value:l?.middle_name||"",onChange:t=>r({...l,middle_name:t.target.value})})]}),e.jsxs("label",{htmlFor:"lastname",children:["Last Name",e.jsx("input",{type:"text",id:"lastname",value:l?.last_name||"",onChange:t=>r({...l,last_name:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"birthdate",children:["Birthdate",e.jsx("input",{type:"date",id:"birthdate",value:l?.birthday,onChange:t=>r({...l,birthday:t.target.value})})]}),e.jsxs("label",{style:{display:"block"},children:["Sex",e.jsxs("div",{id:"gender-div",children:[e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"gender",id:"female",checked:l?.sex==="Female"}),e.jsx("label",{htmlFor:"female",children:"Female"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"gender",id:"male",checked:l?.sex==="Male"}),e.jsx("label",{htmlFor:"male",children:"Male"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",children:["Email",e.jsx("input",{type:"text",id:"email",value:l?.email,onChange:t=>r({...l,email:t.target.value})})]}),e.jsxs("label",{htmlFor:"phone",children:["Phone",e.jsx("input",{type:"text",id:"phone",value:l?.phone,onChange:t=>r({...l,phone:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"idno",children:["ID Number",e.jsx("input",{type:"number",id:"idno",value:l?.student_id||"",onChange:t=>r({...l,student_id:t.target.value})})]}),e.jsxs("label",{htmlFor:"department",children:["Department",e.jsx("input",{type:"text",value:l?.department||"",onChange:t=>r({...l,department:t.target.value})})]}),e.jsxs("label",{htmlFor:"level",children:["Level",e.jsx("input",{type:"number",id:"level",value:l?.level||"",onChange:t=>r({...l,level:t.target.value})})]})]})]}),e.jsxs("div",{id:"medical-information",className:"form-div",children:[e.jsx("p",{className:"form-header",children:"Medical Information"}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("label",{children:"Allergies"}),e.jsx("input",{type:"text",placeholder:"Search Allergies",onClick:()=>D(t=>!t)}),k&&e.jsx("div",{className:"dropdown",children:e.jsx("ul",{children:J})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Conditions"}),e.jsx("input",{type:"text",placeholder:"Search Conditions",onClick:()=>I(t=>!t)}),P&&e.jsx("div",{className:"dropdown",children:e.jsx("ul",{children:$})})]}),e.jsx("div",{style:{display:"block"},children:e.jsxs("label",{htmlFor:"notes",children:["Notes",e.jsx("input",{type:"text",onChange:t=>r({...l,notes:t.target.value})})]})})]})]}),e.jsxs("div",{id:"emergency-contact-information",className:"form-div",children:[e.jsx("p",{className:"form-header",children:"Emergency Contact Information"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"ec-fullname",children:["Full Name",e.jsx("input",{type:"text",id:"ec-fullname",value:l?.emergency_contact_name||"",onChange:t=>r({...l,emergency_contact_name:t.target.value})})]}),e.jsxs("label",{htmlFor:"phone",children:["Phone",e.jsx("input",{type:"text",id:"phone",value:l?.emergency_contact_phone||"",onChange:t=>r({...l,emergency_contact_phone:t.target.value})})]})]})]})]}),e.jsx("div",{id:"cancel-save-div",children:e.jsx(R,{hideForm:u.hideForm,submit:q})})]})]})}function U(u){const[o,_]=s.useState(!1),[l,r]=s.useState([]);return s.useEffect(()=>{_(u.visit)},[u.visit]),s.useEffect(()=>{o&&fetch(`http://localhost:5000/getmedicationdetails?idnum=${o?.visit_id}`).then(c=>c.json()).then(c=>r(c))},[o]),e.jsx("div",{className:"visit-log-overlay",children:e.jsxs("div",{className:"visit-log-card",children:[e.jsxs("div",{className:"visit-log-header",children:[e.jsx("h2",{children:"Visit Log"}),e.jsx("button",{className:"close-btn",onClick:u.hideForm,children:"×"})]}),e.jsxs("div",{className:"visit-log-body",children:[e.jsxs("div",{className:"visit-info",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Patient:"})," ",o?.patient_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(o?.visit_datetime).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Service:"})," ",o?.service_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Weight:"})," ",o?.Weight]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Temperature:"})," ",o?.Temperature]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Staff:"})," ",o?.staff_name]})]}),e.jsxs("div",{className:"visit-notes",children:[e.jsx("h3",{children:"Notes"}),e.jsx("p",{children:o?.notes||"No notes available."})]}),e.jsxs("div",{className:"visit-medications",children:[e.jsx("h3",{children:"Medications"}),l?.length>0?e.jsx("ul",{children:l.map(c=>e.jsxs("li",{children:[e.jsx("span",{className:"med-quantity",children:c.quantity>0?c.quantity+" × ":""}),e.jsx("span",{className:"med-name",children:c.supply_name})]},c.supply_name))}):e.jsx("p",{children:"No medications prescribed."})]})]})]})})}const ne=W(function(){const{id:o}=E(),_=z(),[l,r]=s.useState(!1),[c,N]=s.useState(!1),[p,j]=s.useState(!1),[g,S]=s.useState(!1),[a,v]=s.useState(),[C,w]=s.useState(),[b,F]=s.useState(),[i,x]=s.useState();s.useEffect(()=>{fetch(`http://localhost:5000/getpatient?idnum=${o}`).then(n=>n.json()).then(n=>v(n[0])),fetch(`http://localhost:5000/getpatientcliniclogs?idnum=${o}`).then(n=>n.json()).then(n=>x(n))},[]),s.useEffect(()=>{fetch(`http://localhost:5000/getpatientallergies?idnum=${o}`).then(n=>n.json()).then(n=>w(n))},[]),s.useEffect(()=>{fetch(`http://localhost:5000/getpatientconditions?idnum=${o}`).then(n=>n.json()).then(n=>F(n))},[]);async function h(){await fetch(`http://localhost:5000/getpatient?idnum=${o}`).then(n=>n.json()).then(n=>v(n[0])),fetch(`http://localhost:5000/getpatientallergies?idnum=${o}`).then(n=>n.json()).then(n=>w(n))}return console.log(i),e.jsxs("div",{className:"route-page",id:"patient-details-div",children:[e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>_(-1),className:"back-btn",children:e.jsx("i",{className:"bi bi-caret-left-fill"})}),e.jsx("h1",{className:"route-header",children:"Patient Details"})]}),e.jsx("button",{onClick:()=>N(!0),children:"Edit"}),p&&g?e.jsx(U,{visit:g,hideForm:()=>j(!1)}):null,c?e.jsx(Q,{studentData:a,allergies:C,conditions:b,refetch:h,hideForm:()=>N(!1)}):null,l?e.jsx(B,{hideForm:()=>r(!1)}):null,e.jsxs("div",{children:[e.jsxs("div",{id:"patient-overview-div",children:[e.jsxs("div",{id:"photo-name-div",children:[e.jsx("img",{}),e.jsxs("p",{children:[a?.first_name," ",a?.middle_name," ",a?.last_name]})]}),e.jsxs("div",{id:"patient-information",children:[e.jsxs("div",{id:"student-info",className:"info-div",children:[e.jsxs("p",{className:"patient-info",children:[e.jsx("i",{className:"bi bi-person-fill",style:{marginRight:"0.5rem"}}),"Student Information"]}),e.jsxs("div",{className:"patient-info-div",children:[e.jsxs("p",{children:["Level: ",e.jsx("span",{children:a?.level})]}),e.jsxs("p",{children:["ID Number: ",e.jsx("span",{children:a?.student_id})]}),e.jsxs("p",{children:["Department: ",e.jsx("span",{children:a?.department})]}),e.jsxs("p",{children:["Email: ",e.jsx("span",{children:a?.email})]}),e.jsxs("p",{children:["Phone: ",e.jsx("span",{children:a?.phone})]})]})]}),e.jsxs("div",{id:"medical-info",className:"info-div",children:[e.jsxs("p",{className:"patient-info",children:[e.jsx("i",{className:"bi bi-heart-pulse-fill",style:{marginRight:"0.5rem"}}),"Medical Information"]}),e.jsxs("div",{children:[" ",e.jsx("p",{children:"Allergies:"}),e.jsx("span",{style:{display:"flex",gap:"0.5rem"},children:C?.map(n=>e.jsx("div",{style:{padding:"0.3rem",backgroundColor:"#6dc3ba5d",fontSize:"0.8rem",borderRadius:"10px",border:"1px solid #ccc",width:"fit-content",flexWrap:"wrap"},children:n.allergy_name}))})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Conditions:"}),e.jsx("span",{style:{display:"flex",gap:"0.5rem"},children:b?.map(n=>e.jsx("div",{style:{padding:"0.3rem",backgroundColor:"#6dc3ba5d",fontSize:"0.8rem",borderRadius:"10px",border:"1px solid #ccc",width:"fit-content"},children:n.condition_name}))})]}),e.jsxs("p",{children:["Notes: ",a?.notes]})]}),e.jsxs("div",{id:"emergency-contact",className:"info-div",children:[e.jsxs("p",{className:"patient-info",children:[e.jsx("i",{className:"bi bi-telephone-fill",style:{marginRight:"0.5rem"}}),"Emergency Contact"]}),e.jsxs("p",{children:["Name: ",e.jsx("span",{children:a?.emergency_contact_name})]}),e.jsxs("p",{children:["Contact no: ",e.jsx("span",{children:a?.emergency_contact_phone})]})]})]})]}),e.jsxs("div",{style:{marginTop:"2rem",width:"100%",padding:"1rem 0"},children:[e.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[e.jsx("h2",{style:{fontWeight:"500"},children:"Clinic Visits"}),e.jsx("button",{style:{height:"40px",width:"120px",backgroundColor:"#334FBD",borderRadius:"10px",color:"white",border:"none"},onClick:()=>r(!0),children:"+ Add Record"})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{id:"patient-visit-table",children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Attending"}),e.jsx("th",{children:"Notes"}),e.jsx("th",{})]}),i?.length>0?i?.map(n=>e.jsxs("tr",{children:[e.jsx("td",{children:n.visit_datetime}),e.jsx("td",{children:n.service_name}),e.jsx("td",{children:n.staff_name}),e.jsx("td",{children:n.notes}),e.jsx("td",{children:e.jsx("button",{style:{backgroundColor:"transparent",border:"none",fontSize:"1.2rem"},onClick:()=>{j(!0),S(n)},children:e.jsx("i",{className:"bi bi-eye"})})})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"15px"},children:"No Clinic Records found"})})]})})]})]})]})});export{ne as default};
