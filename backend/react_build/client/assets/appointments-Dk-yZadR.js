import{R as s,p as e,w as A,y as N}from"./chunk-4WY6JWTD-DFeZLFN5.js";/* empty css                   *//* empty css                     *//* empty css                        */import{C as w}from"./cancelsavebtn-CxQDzKWk.js";/* empty css            */function k(p){const[d,f]=s.useState([]),[u,g]=s.useState([]),[i,a]=s.useState({}),[o,c]=s.useState(""),[x,h]=s.useState([]),[r,j]=s.useState(null),[y,m]=s.useState(!1);console.log(i),s.useEffect(()=>{fetch("http://localhost:5000/getallservices").then(t=>t.json()).then(t=>f(t)),fetch("http://localhost:5000/getallpatients").then(t=>t.json()).then(t=>g(t)),a(p.appt)},[]),s.useEffect(()=>{if(!o){h([]);return}const t=u.filter(l=>l.student_id.toString().includes(o)||`${l.first_name} ${l.last_name}`.toLowerCase().includes(o.toLowerCase()));h(t)},[o,u]);const v=t=>{j(t),a({...i,patient_id:t.patient_id}),c(`${t.first_name} ${t.last_name}`),h([])},S=async()=>{try{const t=await fetch("http://localhost:5000/updateappointmentdetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),l=await t.json();t.ok?(alert("Appointment updated successfully!"),a({patient_id:"",service_id:0,appointment_date:"",start_time:"",status:"Upcoming",notes:""}),j(null),c(""),p.hideForm(),p.refetch()):alert("Error saving appointment: "+l.message)}catch(t){console.error(t),alert("Error saving appointment")}finally{m(!1)}};return e.jsxs("div",{className:"modal-form-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Edit Appointment"})}),e.jsx("div",{className:"main-form-content",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"",children:["Select Patient",e.jsx("input",{type:"text",placeholder:"Search patient...",value:i?.patient_name,onChange:t=>c(t.target.value)}),x.length>0&&e.jsx("ul",{id:"search-patients-container",style:{border:"1px solid #ccc",maxHeight:150,overflowY:"auto",padding:0,margin:0,listStyle:"none"},children:x.map(t=>e.jsxs("li",{onClick:()=>v(t),style:{padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"},children:[e.jsxs("div",{children:[t.first_name," ",t.last_name]}),e.jsxs("small",{children:["Student ID: ",t.student_id]})]},t.patient_id))})]}),r&&e.jsxs("div",{id:"patient-chosen",style:{marginTop:"8px"},children:[e.jsxs("p",{children:[r.first_name," ",r.last_name]}),e.jsxs("p",{children:["ID: ",r.student_id]})]}),e.jsxs("label",{htmlFor:"",children:["Service",e.jsxs("select",{name:"",id:"",value:i?.service_id,onChange:t=>a({...i,service_id:t.target.value}),children:[e.jsx("option",{value:0,children:"Select Service"}),d.map(t=>e.jsx("option",{value:t.service_id,children:t.service_name},t.service_id))]})]}),e.jsxs("label",{htmlFor:"date",children:["Date",e.jsx("input",{type:"date",id:"date",value:i?.appointment_date,onChange:t=>a({...i,appointment_date:t.target.value})})]}),e.jsxs("label",{htmlFor:"time",children:["Time",e.jsx("input",{type:"time",min:"09:00",max:"17:00",value:i?.start_time,onChange:t=>a({...i,start_time:t.target.value})})]}),e.jsxs("label",{htmlFor:"",children:["Status",e.jsxs("select",{name:"",id:"",onChange:t=>a({...i,status:t.target.value}),children:[e.jsx("option",{value:"Upcoming",children:"Upcoming"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]})]})}),e.jsx(w,{hideForm:p.hideForm,submit:S})]})]})}const I=A(function(){const[d,f]=s.useState("All Appointments"),[u,g]=s.useState(),i=["All Appointments","Today","Upcoming","Completed","Cancelled"],[a,o]=s.useState([]),[c,x]=s.useState(""),[h,r]=s.useState(!1),j=N(),y=new Date().toISOString().split("T")[0];s.useEffect(()=>{fetch("http://localhost:5000/getallappointments").then(n=>n.json()).then(n=>o(n))},[]);function m(){fetch("http://localhost:5000/getallappointments").then(n=>n.json()).then(n=>o(n))}async function v(n){await fetch("http://localhost:5000/updateappointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appointment_id:n,status:"Completed"})}),m()}async function S(n){await fetch("http://localhost:5000/updateappointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appointment_id:n,status:"Cancelled"})}),m()}const l=a.filter(n=>d==="All Appointments"?!0:d==="Today"?n.appointment_date===y:n.status===d).filter(n=>{const C=n.patient_name?.toLowerCase()||"",_=n.service_name?.toLowerCase()||"",b=c.toLowerCase();return C.includes(b)||_.includes(b)});return e.jsxs("div",{className:"route-page",children:[h?e.jsx(k,{appt:u,hideForm:()=>r(!1),refetch:m}):null,e.jsx("h1",{className:"route-header",children:"Appointments"}),e.jsx("p",{className:"route-page-desc",children:"Manage your clinic's appointments and schedules."}),e.jsx("input",{type:"text",id:"appointments-searchbar",placeholder:"Search by patient or service",value:c,onChange:n=>x(n.target.value)}),e.jsx("button",{id:"add-appointment-btn",onClick:()=>j("/addappointment"),children:"+ Add Appointment"}),e.jsx("div",{id:"today-appointment-status-bar",children:i.map(n=>e.jsx("button",{className:"appointment-status-btn",onClick:()=>f(n),style:{backgroundColor:d===n?"white":" rgb(230, 230, 230)"},children:n},n))}),e.jsx("div",{className:" table-container",children:e.jsxs("table",{className:"appointments-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Patient"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:l.length>0?l.map(n=>e.jsxs("tr",{children:[e.jsx("td",{children:n.patient_name}),e.jsx("td",{children:n.service_name}),e.jsx("td",{children:n.appointment_date}),e.jsx("td",{children:n.start_time}),e.jsx("td",{children:e.jsx("p",{style:{padding:"0.3rem",borderRadius:"10px",color:"white",fontSize:"0.8rem",width:"90px",textAlign:"center",fontWeight:"500",backgroundColor:n.status==="Completed"?"#6EC207":n.status==="Cancelled"?"#ed3e27":"#799EFF"},children:n.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{style:{background:"white",border:"none",fontSize:"1.2rem",color:"#80e50dff"},title:"Mark as Completed",disabled:n.status==="Completed",onClick:()=>v(n.appointment_id),children:e.jsx("i",{className:"bi bi-check-circle-fill"})}),e.jsx("button",{style:{background:"white",border:"none",fontSize:"1.2rem",color:"#ED3F27"},title:"Cancel Appointment",disabled:n.status==="Cancelled",onClick:()=>S(n.appointment_id),children:e.jsx("i",{className:"bi bi-x-circle-fill"})}),e.jsx("button",{style:{background:"white",border:"none",fontSize:"1.2rem",color:"orange"},title:"Edit Appointment",onClick:()=>{g(n),r(!0)},children:e.jsx("i",{className:"bi bi-pen"})})]})})]},n.appointment_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"15px"},children:"No appointments found"})})})]})})]})});export{I as default};
