import{R as s,p as t}from"./chunk-4WY6JWTD-DFeZLFN5.js";/* empty css                 *//* empty css            */import{C as J}from"./cancelsavebtn-CxQDzKWk.js";function H(x){const[y,N]=s.useState(""),[n,o]=s.useState({}),[F,u]=s.useState([]),[A,g]=s.useState([]),[d,h]=s.useState([]),[m,p]=s.useState([]),[L,j]=s.useState(!1),[k,f]=s.useState(!1),[R,$]=s.useState([]),[M,B]=s.useState([]),[r,v]=s.useState(""),[c,C]=s.useState(""),b=F.filter(e=>e.allergy_name.toLowerCase().includes(r.toLowerCase())),_=A.filter(e=>e.condition_name.toLowerCase().includes(c.toLowerCase()));async function O(){console.log(n);let e=!0;if(e=await(await fetch("http://localhost:5000/addpatient",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json(),console.log(e),!e.success){alert("This patient already exists!");return}if(console.log(d),d.length>0){const l=await fetch("http://localhost:5000/getmaxpatientid").then(a=>a.json());await fetch("http://localhost:5000/addpatientallergies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l[0].last_id,allergies:d})})}if(m.length>0){const l=await fetch("http://localhost:5000/getmaxpatientid").then(a=>a.json());await fetch("http://localhost:5000/addpatientconditions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:l[0].last_id,conditions:m})})}alert("Successfully added new patient!"),x.refetchPatients()}s.useEffect(()=>{fetch("http://localhost:5000/getallergies").then(e=>e.json()).then(e=>u(e.sort((i,l)=>i.allergy_name.toLowerCase().localeCompare(l.allergy_name.toLowerCase()))))},[]),s.useEffect(()=>{fetch("http://localhost:5000/getconditions").then(e=>e.json()).then(e=>g(e.sort((i,l)=>i.condition_name.toLowerCase().localeCompare(l.condition_name.toLowerCase()))))},[]);function w(){fetch("http://localhost:5000/getallergies").then(e=>e.json()).then(e=>u(e.sort((i,l)=>i.allergy_name.toLowerCase().localeCompare(l.allergy_name.toLowerCase())))),fetch("http://localhost:5000/getconditions").then(e=>e.json()).then(e=>g(e.sort((i,l)=>i.condition_name.toLowerCase().localeCompare(l.condition_name.toLowerCase()))))}function T(){const e=y.trim();fetch(`http://localhost:5000/getstudent?idnum=${e}`).then(i=>i.json()).then(i=>o({...i[0],is_student:!0})),h([]),p([]),j(!1),f(!1)}async function P(e){if(!e.trim())return;const l=await(await fetch("http://localhost:5000/addnewallergy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({allergy_name:e.trim()})})).json();l.success&&(u(a=>[...a,{allergy_id:l.id,allergy_name:e.trim()}]),h(a=>[...a,l.id]),v("")),w()}async function D(e){if(!e.trim())return;const l=await(await fetch("http://localhost:5000/addnewcondition",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({condition_name:e.trim()})})).json();l.success&&(g(a=>[...a,{condition_id:l.id,condition_name:e.trim()}]),p(a=>[...a,l.id]),C("")),w()}function S(e,i){i==="allergy"?d.includes(e)?h(l=>l.filter(a=>a!==e)):h(l=>[...l,e]):m.includes(e)?p(l=>l.filter(a=>a!==e)):p(l=>[...l,e])}const E=b.map(e=>t.jsxs("li",{children:[t.jsx("input",{type:"checkbox",id:`allergy-${e.allergy_id}`,checked:d.includes(e.allergy_id),onChange:()=>S(e.allergy_id,"allergy")}),t.jsx("label",{htmlFor:`allergy-${e.allergy_id}`,children:e.allergy_name})]},e.allergy_id)),I=_.map(e=>t.jsxs("li",{children:[t.jsx("input",{type:"checkbox",id:`condition-${e.condition_id}`,checked:m.includes(e.condition_id),onChange:()=>S(e.condition_id,"condition")}),t.jsx("label",{htmlFor:`condition-${e.condition_id}`,children:e.condition_name})]},e.condition_id));return t.jsxs("div",{id:"add-new-patient-div",children:[t.jsx("div",{className:"gray-bg"}),t.jsxs("div",{id:"add-patient-form",className:"modal-form",children:[t.jsx("div",{className:"modal-header-div",children:t.jsx("p",{className:"modal-header",children:"Add Patient"})}),t.jsxs("div",{id:"main-add-patient-form",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"search-by-id",style:{display:"inline-block",marginRight:"1rem"},children:t.jsx("input",{type:"text",id:"search-by-id",placeholder:"Search by ID Number",style:{width:"250px"},value:y,onChange:e=>N(e.target.value)})}),t.jsx("button",{style:{height:"40px",width:"80px",borderRadius:"10px",border:"none"},onClick:T,children:"Search"})]}),t.jsxs("div",{id:"student-information",className:"form-div",children:[t.jsx("p",{className:"form-header",children:"Student Information"}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"firstname",children:["First Name",t.jsx("input",{type:"text",id:"firstname",value:n?.first_name||"",onChange:e=>o({...n,first_name:e.target.value})})]}),t.jsxs("label",{htmlFor:"middlename",children:["Middle Name",t.jsx("input",{type:"text",id:"middlename",value:n?.middle_name||"",onChange:e=>o({...n,middle_name:e.target.value})})]}),t.jsxs("label",{htmlFor:"lastname",children:["Last Name",t.jsx("input",{type:"text",id:"lastname",value:n?.last_name||"",onChange:e=>o({...n,last_name:e.target.value})})]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"birthdate",children:["Birthdate",t.jsx("input",{type:"date",id:"birthdate",value:n?.birthday,onChange:e=>o({...n,birthday:e.target.value})})]}),t.jsxs("label",{style:{display:"block"},children:["Sex",t.jsxs("div",{id:"gender-div",children:[t.jsxs("div",{children:[t.jsx("input",{type:"radio",name:"gender",id:"female",checked:n?.sex==="Female"}),t.jsx("label",{htmlFor:"female",children:"Female"})]}),t.jsxs("div",{children:[t.jsx("input",{type:"radio",name:"gender",id:"male",checked:n?.sex==="Male"}),t.jsx("label",{htmlFor:"male",children:"Male"})]})]})]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"email",children:["Email",t.jsx("input",{type:"text",id:"email",value:n?.email,onChange:e=>o({...n,email:e.target.value})})]}),t.jsxs("label",{htmlFor:"phone",children:["Phone",t.jsx("input",{type:"text",id:"phone",value:n?.phone,onChange:e=>o({...n,phone:e.target.value})})]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"idno",children:["ID Number",t.jsx("input",{type:"number",id:"idno",value:n?.student_id||"",onChange:e=>o({...n,student_id:e.target.value})})]}),t.jsxs("label",{htmlFor:"department",children:["Department",t.jsx("input",{type:"text",value:n?.department||"",onChange:e=>o({...n,department:e.target.value})})]}),t.jsxs("label",{htmlFor:"level",children:["Level",t.jsx("input",{type:"number",id:"level",value:n?.level||"",onChange:e=>o({...n,level:e.target.value})})]})]})]}),t.jsxs("div",{id:"medical-information",className:"form-div",children:[t.jsx("p",{className:"form-header",children:"Medical Information"}),t.jsxs("div",{children:[t.jsxs("div",{children:[t.jsx("label",{children:"Allergies"}),t.jsx("input",{type:"text",placeholder:"Search Allergies",onClick:()=>j(e=>!e),onChange:e=>v(e.target.value)}),L&&t.jsxs("div",{className:"dropdown",children:[t.jsx("ul",{children:E}),r&&!b.some(e=>e.allergy_name.toLowerCase()===r.toLowerCase())&&t.jsxs("li",{style:{cursor:"pointer",fontWeight:"bold"},onClick:()=>P(r),children:['+ Add "',r,'"']})]})]}),t.jsxs("div",{children:[t.jsx("label",{children:"Conditions"}),t.jsx("input",{type:"text",placeholder:"Search Conditions",onClick:()=>f(e=>!e),onChange:e=>C(e.target.value)}),k&&t.jsxs("div",{className:"dropdown",children:[t.jsx("ul",{children:I}),c&&!_.some(e=>e.condition_name.toLowerCase()===c.toLowerCase())&&t.jsxs("li",{style:{cursor:"pointer",fontWeight:"bold"},onClick:()=>D(c),children:['+ Add "',c,'"']})]})]}),t.jsx("div",{style:{display:"block"},children:t.jsxs("label",{htmlFor:"notes",children:["Notes",t.jsx("input",{type:"text",onChange:e=>o({...n,notes:e.target.value})})]})})]})]}),t.jsxs("div",{id:"emergency-contact-information",className:"form-div",children:[t.jsx("p",{className:"form-header",children:"Emergency Contact Information"}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"ec-fullname",children:["Full Name",t.jsx("input",{type:"text",id:"ec-fullname",value:n?.emergency_contact_name||"",onChange:e=>o({...n,emergency_contact_name:e.target.value})})]}),t.jsxs("label",{htmlFor:"phone",children:["Phone",t.jsx("input",{type:"text",id:"phone",value:n?.emergency_contact_phone||"",onChange:e=>o({...n,emergency_contact_phone:e.target.value})})]})]})]})]}),t.jsx("div",{id:"cancel-save-div",children:t.jsx(J,{hideForm:x.hideForm,submit:O})})]})]})}export{H as A};
