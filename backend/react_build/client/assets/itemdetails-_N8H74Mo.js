import{z as y,R as c,p as e,w as D,y as B}from"./chunk-4WY6JWTD-DFeZLFN5.js";/* empty css                  */import{C as u}from"./cancelsavebtn-CxQDzKWk.js";/* empty css                        *//* empty css            */function E(d){const{id:l}=y(),[i,a]=c.useState(!1),[n,t]=c.useState({supply_id:l,batch_number:"",expiration_date:"",stock_level:0});async function m(){let o=!0;console.log(n),console.log(i);for(const r of Object.keys(n)){const x=r,h=n[x];if(!(i&&x==="expiration_date")&&(h===""||h==null||h==0)){console.log("INVALID"),o=!1;break}}if(o){const r=await fetch("http://localhost:5000/addbatch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});console.log(r.json()),d.refetch()}else{console.log("Please fill out all form fields!");return}}return e.jsxs("div",{id:"add-batch-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{id:"add-batch-form",className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Add Batch"})}),e.jsxs("div",{className:"main-form-content",children:[e.jsxs("label",{htmlFor:"",children:["Supply Name",e.jsx("input",{type:"text",value:d.name})]}),e.jsxs("label",{htmlFor:"batch-number",children:["Batch Number",e.jsx("input",{type:"text",id:"batch-number",value:n.batch_number,onChange:o=>t({...n,batch_number:o.target.value.trim()})})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"expiration-date",children:["Expiration Date",e.jsx("input",{type:"date",onChange:o=>t({...n,expiration_date:o.target.value.trim()})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",height:"30px"},children:[e.jsx("input",{type:"checkbox",id:"noexpiry",style:{width:"20px",margin:"0 0.5rem 0 0",display:"inline-block",backgroundColor:"none"},onChange:o=>a(o.target.checked)}),e.jsx("label",{htmlFor:"noexpiry",style:{height:"100%",display:"flex",alignItems:"center"},children:"This has no expiration date"})]})]}),e.jsxs("label",{htmlFor:"addstock",children:["Add Stocks",e.jsx("input",{type:"number",min:"0",id:"addstock",value:n.stock_level,onChange:o=>t({...n,stock_level:parseInt(o.target.value)})})]})]}),e.jsx(u,{hideForm:d.hideForm,submit:m})]})]})}function I(d){return e.jsxs("div",{id:"update-stock-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{className:"modal-form",id:"update-stock-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Update Stocks"})}),e.jsxs("div",{className:"main-form-content",children:[e.jsxs("label",{htmlFor:"",children:["Item",e.jsx("input",{type:"text"})]}),e.jsxs("label",{htmlFor:"current-stock",children:["Current Stock",e.jsx("input",{type:"number"})]}),e.jsxs("label",{htmlFor:"add-stock",children:["Add Stock",e.jsx("input",{type:"number",min:"0"})]}),e.jsxs("label",{htmlFor:"remove-stock",children:["Remove Stock",e.jsx("input",{type:"number",min:"0"})]}),e.jsxs("label",{htmlFor:"stock-update-notes",children:["Notes",e.jsx("textarea",{name:"stock-update-notes",id:"stock-update-notes",rows:"4",cols:"35"})]})]}),e.jsx(u,{hideForm:d.hideForm})]})]})}function A(d){const l=d.itemDetails,[i,a]=c.useState({supply_id:l?.supply_id,supply_name:l?.supply_name,description:l?.description,brand:l?.brand,auto_deduct:l?.auto_deduct});async function n(){(await(await fetch("http://localhost:5000/updatesupply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).success&&(alert("Successfully updated supply!"),d.refetch())}return e.jsxs("div",{id:"edit-item-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{className:"modal-form",id:"edit-details-div",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Edit Details"})}),e.jsxs("div",{className:"main-form-content",id:"edit-item-form",children:[e.jsxs("label",{htmlFor:"edit-item-name",children:["Item Name",e.jsx("input",{type:"text",id:"edit-item-name",value:i?.supply_name,onChange:t=>a({...i,supply_name:t.target.value.trim()})})]}),e.jsxs("label",{htmlFor:"",children:["Item Brand",e.jsx("input",{type:"text",value:i?.brand,onChange:t=>a({...i,brand:t.target.value.trim()})})]}),e.jsxs("label",{htmlFor:"",children:["Description",e.jsx("input",{type:"text",value:i?.description,onChange:t=>a({...i,description:t.target.value.trim()})})]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:i?.auto_deduct,onChange:t=>a({...i,auto_deduct:t.target.checked}),style:{width:"30px",display:"inline"}}),"Automatically deduct this item when dispensed.",e.jsx("span",{style:{display:"block",color:"red"},children:"This should only be activated for medicines in units (e.g. capsules, tablets)"})]})]}),e.jsx(u,{hideForm:d.hideForm,submit:n})]})]})}function T(d){async function l(){if(a.item_in==0&&a.item_out==0)return;const t=await fetch("http://localhost:5000/editstockbatch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});console.log(t.json()),d.refetch()}const i=d.batch,[a,n]=c.useState({batch_id:i.batch_id,batch_number:i.batch_number,item_in:0,item_out:0});return e.jsxs("div",{className:"modal-form-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Edit Stocks"})}),e.jsxs("div",{className:"main-form-content",children:[e.jsxs("h3",{children:["Current stocks: ",i.stock_level]}),e.jsxs("label",{htmlFor:"",children:["Batch Number",e.jsx("input",{type:"text",value:a?.batch_number,readOnly:!0})]}),e.jsxs("label",{htmlFor:"addstock",children:["Add Stocks",e.jsx("input",{type:"number",min:"0",id:"addstock",value:a?.item_in,onChange:t=>n({...a,item_in:parseInt(t.target.value)})})]}),e.jsxs("label",{htmlFor:"removestock",children:["Remove Stocks",e.jsx("input",{type:"number",min:"0",max:`${i.stock_level}`,id:"removestock",value:a?.item_out,onChange:t=>t.target.value>i.stock_level?n({...a,item_out:i.stock_level}):n({...a,item_out:parseInt(t.target.value)})})]})]}),e.jsx(u,{hideForm:d.hideForm,submit:l})]})]})}function O(d){const l=d.batch,[i,a]=c.useState({batch_id:l.batch_id,batch_number:l.batch_number,expiration_date:l.expiration_date});async function n(){const t=await fetch("http://localhost:5000/editbatch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});console.log(t.json()),d.refetch()}return e.jsxs("div",{className:"modal-form-div",children:[e.jsx("div",{className:"gray-bg"}),e.jsxs("div",{className:"modal-form",children:[e.jsx("div",{className:"modal-header-div",children:e.jsx("p",{className:"modal-header",children:"Edit Batch"})}),e.jsxs("div",{className:"main-form-content",children:[e.jsxs("label",{htmlFor:"batch-number",children:["Batch Number",e.jsx("input",{type:"text",id:"batch-number",value:i?.batch_number,onChange:t=>a({...i,batch_number:t.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"expiration-date",children:["Expiration Date",e.jsx("input",{type:"date",value:i.expiration_date,onChange:t=>a({...i,expiration_date:t.target.value})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",height:"30px"},children:[e.jsx("input",{type:"checkbox",id:"noexpiry",style:{width:"20px",margin:"0 0.5rem 0 0",display:"inline-block",backgroundColor:"none"}}),e.jsx("label",{htmlFor:"noexpiry",style:{height:"100%",display:"flex",alignItems:"center"},children:"This has no expiration date"})]})]}),e.jsxs("label",{children:["Not",e.jsx("input",{type:"text"})]})]}),e.jsx(u,{hideForm:d.hideForm,submit:n})]})]})}const J=D(function(){const{id:l}=y(),i=B(),[a,n]=c.useState([]),[t,m]=c.useState(),[o,r]=c.useState([]),[x,h]=c.useState(!1),[v,g]=c.useState(!1),[k,j]=c.useState(!1),[_,b]=c.useState(!1),[S,f]=c.useState(!1);console.log(l),c.useEffect(()=>{fetch(`http://localhost:5000/getsupplydetails?idnum=${l}`).then(s=>s.json()).then(s=>n(s[0]))},[]),c.useEffect(()=>{fetch(`http://localhost:5000/getbatches?idnum=${l}`).then(s=>s.json()).then(s=>r(s))},[]);function p(){fetch(`http://localhost:5000/getbatches?idnum=${l}`).then(s=>s.json()).then(s=>r(s))}function N(s){m(s),b(!0)}function F(s){m(s),f(!0)}function C(){b(!1)}function w(){fetch(`http://localhost:5000/getsupplydetails?idnum=${l}`).then(s=>s.json()).then(s=>n(s[0]))}return e.jsx("div",{className:"route-page",children:e.jsxs("div",{id:"item-details-div",children:[S?e.jsx(O,{hideForm:()=>f(!1),batch:t,refetch:p}):null,_?e.jsx(T,{hideForm:C,batch:t,refetch:p}):null,k?e.jsx(A,{hideForm:()=>j(!1),itemDetails:a,refetch:w}):null,v?e.jsx(I,{hideForm:()=>g(!1)}):null,x?e.jsx(E,{hideForm:()=>h(!1),name:a?.supply_name,refetch:p}):null,e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>i(-1),className:"back-btn",children:e.jsx("i",{className:"bi bi-caret-left-fill"})}),e.jsx("p",{className:"route-header",children:"Item Details"})]}),e.jsxs("div",{id:"item-information-div",children:[e.jsx("img",{id:"item-img"}),e.jsx("p",{id:"item-name",children:a?.supply_name}),e.jsx("p",{id:"item-categ",children:a?.category_name}),e.jsxs("p",{id:"item-brand",children:["Brand: ",a?.brand]}),e.jsxs("p",{id:"item-desc",children:["Description: ",a?.description]}),e.jsx("div",{id:"item-edit-button-div",children:e.jsx("button",{id:"edit-details-btn",onClick:()=>j(!0),children:"Edit Details"})})]}),e.jsx("div",{children:e.jsxs("div",{style:{maxWidth:"1400px"},children:[e.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:"500",display:"flex",justifyContent:"space-between"},children:["Batches",e.jsx("span",{children:e.jsx("button",{id:"add-new-batch-btn",onClick:()=>h(!0),children:" Add new batch"})})]}),e.jsx("div",{id:"batches-table-container",className:"table-container",children:e.jsxs("table",{id:"batches-table",children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Batch No."}),e.jsx("th",{children:"Stock Level"}),e.jsx("th",{children:"Expiration Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Updated"}),e.jsx("th",{children:"Actions"})]}),o.length>0?o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.batch_number}),e.jsx("td",{children:s.stock_level}),e.jsx("td",{children:s.expiration_date===""?"None":s.expiration_date}),e.jsx("td",{children:new Date(s.expiration_date)<new Date?"Expired":s.stock_level>20?e.jsx("p",{className:"in-stock",children:"In Stock"}):"Low-Stock"}),e.jsx("td",{}),e.jsxs("td",{children:[e.jsx("button",{style:{fontWeight:"600",fontSize:"1rem",color:"gray",backgroundColor:"transparent",border:"none"},onClick:()=>N(s),children:e.jsx("i",{className:"bi bi-pen-fill"})}),e.jsx("button",{style:{fontWeight:"600",fontSize:"1rem",color:"gray",backgroundColor:"transparent",border:"none"},onClick:()=>F(s),children:e.jsx("i",{className:"bi bi-three-dots-vertical"})})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"15px"},children:"No Batches found"})})]})})]})})]})})});export{J as default};
