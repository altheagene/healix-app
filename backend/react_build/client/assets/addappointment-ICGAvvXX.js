import{w as y,y as b,R as a,p as t}from"./chunk-4WY6JWTD-DFeZLFN5.js";/* empty css                   *//* empty css                     */import{A as P}from"./addpatient-CmzEiQ4u.js";/* empty css            *//* empty css                 */import"./cancelsavebtn-CxQDzKWk.js";const T=y(function(){const f=b(),[j,_]=a.useState([]),[d,p]=a.useState([]),[g,m]=a.useState(!1),[s,n]=a.useState({patient_id:"",service_id:0,appointment_date:"",start_time:"",status:"Upcoming"}),[i,c]=a.useState(""),[h,o]=a.useState([]),[l,u]=a.useState(null),[v,x]=a.useState(!1);a.useEffect(()=>{fetch("http://localhost:5000/getallservices").then(e=>e.json()).then(e=>_(e)),fetch("http://localhost:5000/getallpatients").then(e=>e.json()).then(e=>p(e))},[]),a.useEffect(()=>{if(!i){o([]);return}const e=d.filter(r=>`${r.first_name} ${r.last_name}`.toLowerCase().includes(i.toLowerCase()));o(e)},[i,d]);const S=e=>{u(e),n({...s,patient_id:e.patient_id}),c(`${e.first_name} ${e.last_name}`),o([])},N=async()=>{if(!s.patient_id){alert("Please select a patient first");return}if(!s.service_id||!s.appointment_date||!s.start_time){alert("Please fill all appointment details");return}x(!0);try{const e=await fetch("http://localhost:5000/addappointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),r=await e.json();e.ok?(alert("Appointment saved successfully!"),n({patient_id:"",service_id:0,appointment_date:"",start_time:"",status:"Upcoming",notes:""}),u(null),c("")):alert("Error saving appointment: "+r.message)}catch(e){console.error(e),alert("Error saving appointment")}finally{x(!1)}};return t.jsxs("div",{className:"route-page add-appointment-page",children:[g?t.jsx(P,{hideForm:()=>{m(!1),fetch("http://localhost:5000/getallpatients").then(e=>e.json()).then(e=>p(e))}}):null,t.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[t.jsx("button",{onClick:()=>f(-1),className:"back-btn",children:t.jsx("i",{className:"bi bi-caret-left-fill"})}),t.jsx("h1",{className:"route-header",children:"Add Appointment"})]}),t.jsxs("div",{className:"appointment-flex",children:[t.jsxs("div",{className:"card appointment-details",children:[t.jsx("p",{className:"section-title",children:"Appointment Details"}),t.jsxs("label",{children:["Service",t.jsxs("select",{value:s.service_id,onChange:e=>n({...s,service_id:Number(e.target.value)}),children:[t.jsx("option",{value:0,children:"Select Service"}),j.map(e=>t.jsx("option",{value:e.service_id,children:e.service_name},e.service_id))]})]}),t.jsxs("label",{children:["Date",t.jsx("input",{type:"date",value:s.appointment_date,onChange:e=>n({...s,appointment_date:e.target.value})})]}),t.jsxs("label",{children:["Time",t.jsx("input",{type:"time",min:"09:00",max:"17:00",value:s.start_time,onChange:e=>n({...s,start_time:e.target.value})})]}),t.jsx("button",{className:"primary-btn",onClick:N,disabled:v,children:v?"Saving...":"Save Appointment"})]}),t.jsxs("div",{className:"card appointment-patient",children:[t.jsx("p",{className:"section-title",children:"Select Patient"}),t.jsx("input",{type:"text",className:"search-input",placeholder:"Search patient...",value:i,onChange:e=>c(e.target.value)}),h.length>0&&t.jsx("ul",{className:"search-results",children:h.map(e=>t.jsxs("li",{onClick:()=>S(e),children:[t.jsxs("div",{children:[e.first_name," ",e.last_name]}),t.jsxs("small",{children:["ID: ",e.student_id]})]},e.patient_id))}),l&&t.jsxs("div",{className:"selected-patient",children:[t.jsxs("p",{className:"name",children:[l.first_name," ",l.last_name]}),t.jsxs("p",{className:"sid",children:["Student ID: ",l.student_id]})]}),t.jsx("button",{className:"secondary-btn",onClick:()=>m(!0),children:"Register New Patient"})]})]})]})});export{T as default};
